@model IEnumerable<vertacnik_TallerMecanico2025.Models.Usuario>

@if (Model != null && Model.Any())
{
    foreach (var u in Model)
    {
        <tr>
            <td>@u.IdUsuario</td>
            <td>
                @if (!string.IsNullOrEmpty(u.Avatar))
                {
                    <img src="@Url.Content(u.Avatar)" alt="Foto de perfil" class="rounded-circle user-perfil-foto" style="width: 32px; height: 32px;" />
                }
                else
                {
                    string? inicial = u.Nombre.Length > 0 ? u.Nombre.Substring(0, 1).ToUpper() : "?"; 
                    <div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center user-perfil-foto" style="width: 32px; height: 32px;">
                        @inicial
                    </div>
                }
            </td>
            <td>@u.Nombre</td>
            <td>@u.Apellido</td>
            <td>@u.Dni</td>
            <td>@u.Telefono</td>
            <td>@u.Email</td>
            <td>@u.Rol</td>
            <td>
                @if (u.Estado)
                {
                    <span class="badge bg-success" style="padding: 10px;">Activo</span>
                }
                else
                {
                    <span class="badge bg-secondary" style="padding: 10px;">Inactivo</span>
                }
            </td>
            <td>
                @if (u.Estado)
                {
                    <a href="javascript:void(0);" class="btn btn-sm btn-primary btn-editar-usuario" data-id="@u.IdUsuario">Editar</a>
                    @if (User.Identity.IsAuthenticated && User.HasClaim("Rol", "Administrador")) {
                    <button class="btn btn-sm btn-danger" onclick="cambiarEstado(@u.IdUsuario, false)">Baja</button>
                    }
                }
                else
                {
                    @if (User.Identity.IsAuthenticated && User.HasClaim("Rol", "Administrador")) {
                    <button class="btn btn-sm btn-success" onclick="cambiarEstado(@u.IdUsuario, true)">Alta</button>
                    }
                }
            </td>
        </tr>
    }
}
else
{
    <tr>
        <td colspan="10" class="text-center">No hay usuarios registrados.</td>
    </tr>
}